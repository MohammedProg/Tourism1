<!DOCTYPE html>
<html lang="en">
<head>

<script src="https://cdnjs.cloudflare.com/ajax/libs/crypto-js/4.1.1/crypto-js.min.js"></script>

    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Register</title>
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/css/bootstrap.min.css" rel="stylesheet">
    <link rel="stylesheet" href="style.css">
</head>
<body>
    <header>
        <nav>
            <ul>
                <li><a href="index.html">العودة إلى القائمة الرئيسية / Back to Home</a></li>
            </ul>
        </nav>
    </header>

    <main>
        <h1 class="text-center mb-4">Register</h1>
        <form id="registerForm">
            <input type="text" id="regName" placeholder="Your Name" required>
            <input type="email" id="regEmail" placeholder="Email Address" required>
            <input type="password" id="regPassword" placeholder="Password" required>
            <button type="submit">Register</button>
        </form>
        <div id="regMessage"></div>
        <p class="text-center mt-3"><a href="login.html">Login</a></p>
    </main>

    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/js/bootstrap.bundle.min.js"></script>
    <script>
        document.getElementById('registerForm').addEventListener('submit', function(e) {
            e.preventDefault();
            const name = document.getElementById('regName').value;
            const email = document.getElementById('regEmail').value;
            const password = document.getElementById('regPassword').value;

            if (password.length < 8) {
            document.getElementById('regMessage').innerHTML = '<div class="error">Password must be at least 8 characters!</div>';
            return;
        }
        if (!/[A-Z]/.test(password)) {
            document.getElementById('regMessage').innerHTML = '<div class="error">Password must include at least one uppercase letter!</div>';
            return;
        }
        if (!/[a-z]/.test(password)) {
            document.getElementById('regMessage').innerHTML = '<div class="error">Password must include at least one lowercase letter!</div>';
            return;
        }
        if (!/[0-9]/.test(password)) {
            document.getElementById('regMessage').innerHTML = '<div class="error">Password must include at least one number!</div>';
            return;
        }
        if (!/[^A-Za-z0-9]/.test(password)) {
            document.getElementById('regMessage').innerHTML = '<div class="error">Password must include at least one symbol (e.g., !@#$%)</div>';
            return;
        }

            let users = JSON.parse(localStorage.getItem('users')) || [];
            if (users.find(u => u.email === email)) {
                document.getElementById('regMessage').innerHTML = '<div class="error">Email already registered!</div>';
                return;
            }

        // newly added , encryption (hash the password before saving it)
        const hashedPassword = CryptoJS.SHA256(password).toString();

        users.push({ name, email, password: hashedPassword });  // Save hashed version
        localStorage.setItem('users', JSON.stringify(users));
        document.getElementById('regMessage').innerHTML = '<div class="success">Registered successfully! Go to login.</div>';
        this.reset();
    });
</script>
</html>